{% extends "base.html" %}

{% block title %}Profile - MCAN Lagos{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="max-w-4xl mx-auto bg-white rounded-lg shadow-md overflow-hidden">
        <div class="p-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-6">My Profile</h1>
            
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <!-- Profile Information -->
                <div class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Full Name</label>
                        <input type="text" id="fullName" value="{{ user.profile.full_name }}" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Email</label>
                        <input type="email" value="{{ user.email }}" disabled class="mt-1 block w-full rounded-md border-gray-300 shadow-sm bg-gray-50">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Phone Number</label>
                        <input type="tel" id="phone" value="{{ user.profile.phone }}" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700">State Code</label>
                        <input type="text" id="stateCode" value="{{ user.profile.state_code }}" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500">
                    </div>
                </div>
                
                <!-- Additional Information -->
                <div class="space-y-6">
                    <div>
                        <label class="block text-sm font-medium text-gray-700">PPA</label>
                        <input type="text" id="ppa" value="{{ user.profile.ppa }}" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700">LGA</label>
                        <input type="text" id="lga" value="{{ user.profile.lga }}" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Bio</label>
                        <textarea id="bio" rows="4" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring-green-500">{{ user.profile.bio }}</textarea>
                    </div>
                </div>
            </div>
            
            <!-- Save Button -->
            <div class="mt-8 flex justify-end">
                <button type="button" onclick="saveProfile()" class="bg-green-600 text-white px-6 py-2 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2">
                    Save Changes
                </button>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript for Profile Updates -->
<script>
function saveProfile() {
    const data = {
        full_name: document.getElementById('fullName').value,
        phone: document.getElementById('phone').value,
        state_code: document.getElementById('stateCode').value,
        ppa: document.getElementById('ppa').value,
        lga: document.getElementById('lga').value,
        bio: document.getElementById('bio').value
    };
    
    fetch('/members/api/profile', {
        method: 'PUT',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(data => {
        if (data.message) {
            alert('Profile updated successfully!');
        } else {
            alert('Error: ' + data.error);
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('An error occurred while updating your profile.');
    });
}
</script>
{% endblock %} 